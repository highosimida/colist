# colist

总体设计：

系统设计图

整体设计分为两大部分，SpiderCore 和 SpiderManager， SpiderCore 为爬虫内核，SpiderManager 为爬虫、数据集等管理模块。下面分别对这两大模块进行说明。

SpiderCore 要实现的功能是让编写爬虫脚本更加简单方便，本身提供强大的分布式、异步、并发等功能，方便水平扩展，以满足大规模爬取需求。SpiderCore 主要有以下组件构成：存储件、调度器、下载器、解析器、

不同的组件之间通过消息队列来进行通信，每个组件包括消息队列本身，都运行在自己独立的进程里。借助于这样的设计，可以方便的实现分布式部署，只需要将不同的组件，运行于不同的机器即可，同时也很方便进行水平扩展，如果某部分运行较慢，比如解析有些慢，可以部署多个解析器，来提升解析性能。

调度器：从 newtask 队列获取新的任务，newtask 队列中的任务由解析器模块产生，调度器还负责不断检查项目状态，更新爬虫项目，持久化下载任务，并将有效的下载任务传给下载器组件。调度器组件目前只能部署一个实例。

下载器：发起网络请求，下载网络资源的组件，使用 tornado 异步组件进行构建，自动配置 User-Agent，可插拔代理配置。下载器有一个输入队列和输出队列，输入队列传入下载任务，输出队列传出下载结果给解析器。

解析器：负责从输入队列取得下载结果，根据结果绑定的任务，读取相应爬虫驱动脚本源码，加载驱动脚本，找到驱动脚本中用于处理相应结果的方法，将下载结果传个对应方法进行解析，根据解析的情况，生成新的下载任务或者返回解析结果，将新下载任务放入 newtask 队列，解析结果传给结果处理组件

结果处理组件：主要负责将下载结果存入对应数据库

整个爬虫的数据流：

各组件详细说明？

SpiderManager：用户认证和授权、爬虫管理、数据集管理、代理池管理

ip池：含有爬取免费代理和接入收费代理的功能，内建代理有效性验证，过期代理管理
